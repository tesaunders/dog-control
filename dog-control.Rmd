---
title: "Dog Control"
author: "Tom Saunders"
output: html_document
knit: (function(inputFile, encoding) { rmarkdown::render(inputFile, encoding = encoding, output_file = file.path(dirname(inputFile), 'index.html')) })
---

```{r, message=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(stringr)
```

```{r, message=FALSE}
dog_data <- read_csv("data/dog-control.csv")
```

```{r}
# Summaries of dogs and owners

dogs <- dog_data |> 
  filter(category == "registrations" | category == "classification") |> 
  group_by(financial_year) |> 
  select(-category) |> 
  pivot_wider(names_from = c(subcategory, measure), values_from = value) |> 
  select(-dangerous_total, -(starts_with("shelters"))) |> 
  mutate(
    menacing = menacing_33A + menacing_33C,
    dangerous = dangerous_conviction + dangerous_evidence + dangerous_admission,
    pc_men = menacing / dogs_known,
    pc_dan = dangerous / dogs_known,
  )

owners <- dog_data |> 
  filter(subcategory == "owners" | subcategory == "prosecution-appeal") |> 
  group_by(financial_year) |> 
  select(-category) |> 
  pivot_wider(names_from = c(subcategory, measure), values_from = value)
```

```{r}

```


